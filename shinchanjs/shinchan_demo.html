<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
          "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="DMRS Visualisation - Version 0.3.1">
    <meta name="author" content="Le Tuan Anh <tuananh.ke@gmail.com">
    <link rel="icon" href="../../favicon.ico">
    <!-- Title and styles -->
    <title>ShinchanJS Showcase</title>
    <!-- Bootstrap core CSS -->
    <link href="bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <!-- Visko -->
    <link rel="stylesheet" href="css/visko2.css" />
  </head>
  
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="shinchan_demo.html">ShinchanJS showcases</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="index_home.html">Home</a></li>
          </ul>
        </div><!--/.navbar-collapse -->
      </div>
    </nav>

    <div style="padding: 60px 20px;">
      <div class="row">
        <div class="col-md-6">
          <!-- Left column -->
          <h1>ShinchanJS showcase</h1>
          <div id="main_canvas"></div>
          <br/>
          <input type="button" class="btn btn-default" id="btnLeft" name="btnLeft" value="Left"/>
          <input type="button" class="btn btn-default" id="btnUp" name="btnUp" value="Up"/>
          <input type="button" class="btn btn-default" id="btnDown" name="btnDown" value="Down"/>
          <input type="button" class="btn btn-default" id="btnRight" name="btnRight" value="Right"/>
          - Speed: <input type="text" id="txtSpeed" name="txtSpeed" value="10"/>
          
          <div id="holder1"></div>
          <div id="holder2"></div>
          
          <input type="button" id="btn1" name="btn1" class="btn btn-default" value="Expand"/>
          <input type="button" id="btn2" name="btn2" class="btn btn-default" value="Collapse"/>
          <!-- End DMRS column -->
        </div>
        <div class="col-md-6">
          <!-- Control Panel and Console -->
          <div id="toolbar" style="padding: 20px;">
            <div class="row">
              <button type="button" id="btnInfo" name="btnInfo" class="btn btn-primary">Information</button>
              <button type="button" id="btnClear" name="btnClear" class="btn btn-default">Clear Console</button>
              <button type="button" id="btnHide" name="btnHide" class="btn btn-default">Hide Console</button>  
            </div>
          </div>
          <div id="console" style="overflow: auto; max-height: 80vh;"></div>
        </div>
      </div>

      <hr>

      <footer>
        <p>&copy; 2012-2017 Le Tuan Anh &lt;tuananh.ke@gmail.com&gt;</p>
      </footer>
    </div> <!-- /container -->
    
    <!-- Bootstrap -->
    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- ShinchanJS scripts -->
    <script src="js/raphael.js"></script>
    <script src="js/console.js"></script>
    <script src="js/shinchan.js"></script>
    <script src="js/shinchan.debug.js"></script>
    <script src="js/visko-2.0.js"></script>
    <script src="js/kajika.js"></script>
    <script>
     var canvas;
     var paper1;
     var paper2;
     var layer1;
     
     function getSpeed(){
       _speed = parseInt($("#txtSpeed").val());
       //console.writeline("Speed: " + _speed);
       return _speed;
     }
     
     function initialise(){
       // Create canvas
       canvas = new ChibiJS.ShinChan.Canvas("main_canvas", 320, 240);	
       paper1 = new ChibiJS.ShinChan.Canvas("holder1", 50, 25);
       paper2 = new ChibiJS.ShinChan.Canvas("holder2", 25, 50);
       
       layer1 = canvas.addLayer("MainLayer");
       line1 = new Path().moveTo(20,60).lineTo(80,60).drawTo(layer1, "Hand-Path");//layer1.draw_path("M20,60L,80,60", "Hand");
       line2=layer1.draw_line(50,50, 50,90, "Body");
       label=layer1.draw_label(50,40, "(^o^)", 10, 10, "Face");
       link1=layer1.draw_link(30,120,70,90, "Feet");
       stickman = layer1.group([line1, line2, label, link1],"Stickman");
       stickman.moveTo(100,100);
       
       var flowlayer = canvas.addLayer("flowlayer");
       hflow = new HorizontalFlow(layer1); 
       l1 = flowlayer.draw_label(300, 20, "Diagonals", 2, 2, "diagonal-box", 0, "diagonals");
       hflow.addElement(l1);
       l2 = flowlayer.draw_label(300, 20, "Rounded", 2, 2, "rounded-box", 0, "rounded");
       hflow.addElement(l2);
       l3 = flowlayer.draw_label(300, 20, "Normal Rectangle", 2, 2, "rect-box", 0, "rect");
       hflow.addElement(l3);
       l4 = flowlayer.draw_label(300, 20, "Parallelogram", 2, 2, "parl-box", 0, "parallelogram");
       hflow.addElement(l4);
       l5 = flowlayer.draw_label(300, 20, "hexagon pro", 2, 2, "parl-box", 0, "hexagon");
       hflow.addElement(l5);
       hflow.rearrange();
       
       
       layer2 = canvas.addLayer("Ad");
       banner = layer2.draw_label(200, 40, "SHINCHAN ENGINE TEST", 20, 20, "Test banner");
       dump_element(banner);
       banner.moveTo(2, 2);
       //console.writeline("Shift X = :1 Y = :2".replace(":1", shift_x).replace(":2", shift_y));
       //dump_element(banner);
       console.writeline();
       
       // Register event handlers
       $(document).keypress(function(e){
	 if (e.keyCode == 37) {  layer1.translate(-getSpeed(),0); return false; } // Left
	 else if(e.keyCode == 38) { layer1.translate(0,-getSpeed()); return false; } // Up
	 else if(e.keyCode == 39) { layer1.translate(getSpeed(),0); return false; } // Right
	 else if(e.keyCode == 40) { layer1.translate(0,getSpeed()); return false; } // Down
       });

       $('[name="btnLeft"]').click(function(){ layer1.translate(-getSpeed(),0); return false; });
       $('[name="btnRight"]').click(function(){ layer1.translate(getSpeed(),0); return false; });
       $('[name="btnUp"]').click(function(){ layer1.translate(0,-getSpeed()); return false; });
       $('[name="btnDown"]').click(function(){ layer1.translate(0,getSpeed()); return false; });		
       $('#btnInfo').click(function(){
	 clear_console();
	 displayInformation();
       });
       
       // Test resize canvas
       $("#btn1").click(function(){
	 paper1.resize(100,25);
	 paper2.resize(25,100);
	 
       });
       $("#btn2").click(function(){
	 paper1.resize(25,50);
	 paper2.resize(50,25);
       });
     }
     
     $(document).ready(function(){
       init_console();
       initialise();
       background = canvas.addLayer("Background");
       c = background.draw_circle(50,50, 20, "BALL").fill("yellow").toBack().stroke("- ");
       r = background.draw_rect(10,20, 100, 200, "BOX").fill("cyan").stroke("-.").toBack();
       lblClickMe = background.draw_label(200, 100, "Click this!!!");
       arrow = background.draw_arrow(
	 lblClickMe.location.x, lblClickMe.centre.y, 
	 c.location.x + c.size.width, c.centre.y
	 , "pointer", 20, 10);

       do1 = function(){ console.writeline("OOPS"); };
       do2 = function(){ console.writeline("ARRRGS!!!"); };
       do3 = function(){ console.writeline("CRACKED!!!"); };
       
       c.click(do1);
       //c.getObject().unclick(do1);
       c.click(do2);
       c.click(do3);
       c.hover(function(){ // in
	 arrow.hide();
	 lblClickMe.hide();
       }
	     , function(){ // out
	       arrow.show();
	       lblClickMe.show();
	     });
       
       // Test draw arrow
       arr_layer = canvas.addLayer("ARROW");
       from = new Point(350, 150);
       to = new Point(350, 50);		
       arrow_length = 20;
       arrow_count = 36;
       for(i = 1; i <= arrow_count; i++){
	 new_to = ChibiJS.Geometry.rotate(i*360 / arrow_count, to, from);
	 arr_layer.draw_arrow(from.x, from.y, new_to.x, new_to.y, "ARRRR", 20, 10);
       }
       
       canvas.pack(20);
       // displayInformation();
     });
    </script>
    
    <!-- Console support -->
    <script>
     var console;

     function init_console(){
       // Console support
       console = new Console("console");
       $("#btnClear").click(clear_console);
       $("#btnHide").click(toggleConsole);
       clear_console();
       update_console();
     }
     
     $(window).on('resize', function(){
       update_console();
     });

     function toggleConsole(){
       $("#console").toggle();
       if($("#console").is(":visible")){
         $("#btnHide").prop('value', "Hide Console");                
       } 
       else{
         $("#btnHide").prop('value', "Show Console");
       }
     }
     
     function update_console(){
       var ch = $(window).height() - 160;
       if (ch < 300){
         ch = 300;
       }
       $("#console").height(ch);
       $("#console").css('max-height', ch);
       //console.writeline("Window's height: " + $(window).height());
     }

     function clear_console() {
       console.clear("Synset Demo");
       console.writeline();
     }
    </script>
  </body>
</html>
